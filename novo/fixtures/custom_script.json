[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2019-01-26 20:10:50.428869", 
  "name": "Sales Order-Client", 
  "script": "cur_frm.dashboard.frm.fields[0].df.collapsible=0\nfrappe.ui.form.on('Sales Order', {\n\tbefore_submit: function(frm) {\n\t\tfrappe.call({\n\t\t\tmethod:\"erpnext.api.addMeasurement\",\n\t\t\targs:{'doc_name':frm.doc.name},\n\t\t\tcallback:function(r){\n\t\t\t\t\tconsole.log(r);\n\t\t\t\t\tcur_frm.reload_doc()\n\t\t\t}\n\n\t\n\t\t\n\n})\n\n\t\t\n\n\n\t},\n  new_measurement: function(frm, cdt, cdn){\nif(cur_frm.doc.new_measurement==1){\nfrappe.route_options = {\"customer\":frm.doc.customer};\n   frappe.set_route(\"Form\", \"Measurement\", \"New Measurement 1\")\n\t}\n  },\n\n\n\nonload:function(frm,cdt,cdn){\n\tvar prev_route = frappe.get_prev_route();\n\tconsole.log(prev_route);\n\tif(cur_frm.doc.__islocal){\n\n\t\tfrappe.model.set_value(cdt,cdn,\"delivery_date\",frappe.datetime.add_days(frappe.datetime.nowdate(),28))\n\t\tfrappe.model.set_value(cdt,cdn,\"company\",\"Deft Tailoring Ltd.\")\n\t\t}\n\tif(!cur_frm.doc.__islocal){\nfrm.add_custom_button(__('Send Message'), function() {\nfrappe.call({\n        method: \"frappe.client.get\",\n        args: {\n            doctype: \"Parameter Table\",\n            name: \"parameter\",\n        },\n        callback(r) {\n            if(r.message) {\n                var res = r.message;\n\t\tconsole.log(res)\n\nfrappe.call({\n\t\t\t\t\t\"method\": \"frappe.client.set_value\",\n\t\t\t\t\t\"args\": {\n\t\t\t\t\t\t\"doctype\": \"Send Message\",\n\t\t\t\t\t\t\"name\": res.send_message,\n\t\t\t\t\t\t\"fieldname\": {\n\t\t\t\t\t\t\t//You can update as many fields as you want.  \n\t\t\t\t\t\t\t\"sales_order\": frm.doc.name,\n\t\t\t\t\t\t\t\"customer\": frm.doc.customer,\n\t\t\t\t\t\t\t\"customer_name\": frm.doc.customer_name,\n\t\t\t\t\t\t\t\"contact_no\": frm.doc.contact_no,\n\t\t\t\t\t\t\t\"message_type\":'',\n\t\t\t\t\t\t\t\"message\":''\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tcallback:function(r){\n\n\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Send Message\",res.send_message);\n\t\t\t\t\t}\n\t\t\t\t});\n\n            }\n        }\n    });\n\n\n})\n\n\n\n\tfrm.add_custom_button(__('Make Visit'), function() {\n\n\t\t\tfrappe.call({\n\t\t\t\tmethod:'novo.api.makeVisit',\n\t\t\t\targs:{'customer':frm.doc.customer,'customer_name':frm.doc.customer_name,'sales_order':frm.doc.name},\n\t\t\t\tcallback:function(res){\n\n\t\t\t\t\t\tif(res.message){\n\t\t\t\t\t\t\tvar msg='';\n\t\t\t\t\t\t\tmsg=msg+'<a  style=\"color:#7277FF\" href=\"#Form/Visit/'+res.message+'\">'+res.message+'</a>'\n\t\t\t\t\t\t\tfrappe.msgprint(\"Visit Created:\"+msg);\n\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\n\t\t\t})\n\n\t}\n\n\n},\n\trefresh:function(frm,cdt,cdn){\n\n\t\tconsole.log(frappe.route_options)\n\t\tif(!frm.doc.measurement){\n\t\t\tfrappe.model.set_value(cdt,cdn,\"measurement\",frappe.route_options.measurement)\n  \t\t\t\t  cur_frm.set_df_property(\"new_measurement\",\"read_only\",1);\t\t\n\t\t}\n\t\t\tif(frm.doc.docstatus==1){\n\t\t\tfrm.add_custom_button(__('Make Production Order'), function() {\n\n\t\t\t\tfrappe.call({\n\t\t\t\t\t\t'method':'novo.api.makeMultiplePO',\n\t\t\t\t\t\t'args':{'doc_name':frm.doc.name},\n\t\t\t\t\t\t'freeze':true,\n\t\t\t\t\t\t'freeze_message':'Please Wait..',\n\t\t\t\t\t\tcallback:function(r){\n\t\t\t\t\t\t\tif(r.message){\n\t\t\t\t\t\t\tstr_msg=r.message;\n\t\t\t\t\t\t\tstr_msg=str_msg.slice(0,-1);\n\t\t\t\t\t\t\tmsg='Production Orders Created:';\n\t\t\t\t\t\t\tmsg=msg+str_msg;\n\t\t\t\t\t\t\tfrappe.msgprint(msg);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t\t})\n\n\n\t\t\t})\n//sample\n\t\t\tfrm.add_custom_button(__('Make Sample Production Order'), function() {\n\n\t\t\t\tfrappe.call({\n\t\t\t\t\t\t'method':'novo.api.makeMultipleSamplePO',\n\t\t\t\t\t\t'args':{'doc_name':frm.doc.name},\n\t\t\t\t\t\t'freeze':true,\n\t\t\t\t\t\t'freeze_message':'Please Wait..',\n\t\t\t\t\t\tcallback:function(r){\n\t\t\t\t\t\t\tif(r.message){\n\t\t\t\t\t\t\tstr_msg=r.message;\n\t\t\t\t\t\t\tstr_msg=str_msg.slice(0,-1);\n\t\t\t\t\t\t\tmsg='Sample Production Orders Created:';\n\t\t\t\t\t\t\tmsg=msg+str_msg;\n\t\t\t\t\t\t\tfrappe.msgprint(msg);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t\t})\n\n\n\t\t\t})\n\n\n\t\t\t}\nconsole.log(frm.doc.new_measurement);\n\ncur_frm.set_query(\"measurement\", function () {\nif(frm.doc.new_measurement==1){\n    return{\n        filters: {'customer':'ABCD'}\n    }\n}\nif(frm.doc.new_measurement==0){\n    return{\n        filters: {'customer':cur_frm.doc.customer}\n    }\n}\n});\n\n\n\n\n\n},\n\tafter_save:function(frm){\n\n\t\tsetTimeout(function(){\n\t\tcur_frm.reload_doc()\n\n\t\t},2000)\n\n},\n\tdefault_fabric: function(frm) {\n\t\t$.each(frm.doc.items || [], function(i, d) {\n\t\t\tif(d.band==frm.doc.band){\n\t\t\tif(!d.fabric_no) d.fabric_no = frm.doc.default_fabric;\n\t\t\t}\n\t\t});\n\t\trefresh_field(\"items\");\n\t}\n\t\n});\n\ncur_frm.set_query(\"default_fabric\", function () {\n    return{\n        filters: { 'item_group':'Main Fabric' }\n    }\n});\n\ncur_frm.fields_dict['items'].grid.get_field('bom').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [[\n                'BOM', 'item', '=', child.item_code\n            ]]\n        }\n    };\n\n\ncur_frm.fields_dict['items'].grid.get_field('drawing_no').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [[\n                'Drawing', 'prefix', '=', child.prefix\n            ]]\n        }\n    };\n\n\n\ncur_frm.fields_dict['items'].grid.get_field('fabric_no').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [['Item', 'item_group', '=', 'Main Fabric'],['Item', 'material_type', '=', child.band]]\n        }\n    };\ncur_frm.fields_dict['items'].grid.get_field('jacket_options').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [['Jacket Options', 'name', '=', '1ABCD']]\n        }\n    };\n\ncur_frm.fields_dict['items'].grid.get_field('trousers_options').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [['Trousers Options', 'name', '=', '1ABCD']]\n        }\n    };\n\ncur_frm.fields_dict['items'].grid.get_field('waistcoat_options').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [['Waistcoat Options', 'name', '=', '1ABCD']]\n        }\n    };\n\n\ncur_frm.fields_dict['items'].grid.get_field('lining_no').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [[\n               'Item', 'item_group', '=', 'Lining'\n            ]]\n        }\n    };\ncur_frm.fields_dict['items'].grid.get_field('button').get_query = function(doc,cdt,cdn) {\nvar child=locals[cdt][cdn]\n        return {\n            filters: [[\n                'Item', 'item_group', '=', 'Accessories'\n            ]]\n        }\n    };\n\nfrappe.ui.form.on('Sales Order Item', {\nmake_sample_production_order:function(frm,cdt,cdn){\n\tvar doc=locals[cdt][cdn]\n\tconsole.log(doc)\n\t\n\n\n},\nmake_production_order1:function(frm,cdt,cdn){\n\tvar doc=locals[cdt][cdn]\n\tfrappe.call({\n\t\tmethod:\"novo.api.makeProductionOrder\",\n\t\targs:{'item_code':doc.item_code,'bom':doc.bom_no,'qty':doc.qty,'sales_order':doc.parent,'sales_order_item':doc.name,'warehouse':doc.warehouse,'d_no':doc.drawing_no,'measurement_no':cur_frm.doc.measurement},\n\t\tcallback:function(r){\n\n\t\t\t\tif(r.message){\n\t\t\t\t\t\tmsg='Production Order Created: '+'<a href=\"#Form/Production Order/'+r.message+'\">'+r.message+'</a>'\n\t\t\t\t\t\tfrappe.msgprint(msg);\n\t\t\t\t\t\tcur_frm.reload()\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t})\n\n\n},\nnew_drawing:function(frm,cdt,cdn){\n\tvar row=locals[cdt][cdn];\n\tif(row.drawing_no){\n\t\tfrappe.throw(\"Drawing Already Created\")\n\t}\n\tif(!cur_frm.doc.measurement){\n\t\tfrappe.throw(\"Measurement Is Mandatory For Drawing\")\n\t\t}\n\tif(!row.garment_type){\n\t\tfrappe.throw(\"Garment Type Is Mandatory For Drawing\")\n\t\t}\n\tif(row.garment_type==\"Jacket\"){\n\t\t\tif(!row.jacket_options){\n\t\t\t\tfrappe.throw(\"Jacket Option Mandatory For Drawing\")\t\n\t\t\t}\t\n\t}\n\tif(row.garment_type==\"Trousers\"){\n\t\t\tif(!row.trousers_options){\n\t\t\t\tfrappe.throw(\"Trousers Option Mandatory For Drawing\")\t\n\t\t\t}\t\n\t}\n\tif(row.garment_type==\"Waistcoat\"){\n\t\t\tif(!row.waistcoat_options){\n\t\t\t\tfrappe.throw(\"Waistcoat Option Mandatory For Drawing\")\t\n\t\t\t}\t\n\t}\n\tif(!row.prefix){\n\t\tfrappe.throw(\"Prefix For Item Is Mandatory For Drawing\")\n\t\t}\n\n\tif(cur_frm.doc.measurement){\n\t\tfrappe.call({\n\t\t\tmethod:'novo.api.makeDrawing',\n\t\t\targs:{'customer':cur_frm.doc.customer,'customer_name':cur_frm.doc.customer_name,'garment':row.garment_type,'prefix':row.prefix,'measurement':cur_frm.doc.measurement,'item_code':row.item_code,'j_option':row.jacket_options,'t_option':row.trousers_options,'w_option':row.waistcoat_options},\ncallback:function(r){\n\t\tif(r.message){\n\t\t\tfrappe.model.set_value(cdt,cdn,\"drawing_no\",r.message)\n\t\t}\n\n\t}\n\n\n\t\t})\n\n\t}\n},\nitem_code:function(frm,cdt,cdn){\n\t\tvar row = locals[cdt][cdn];\n\t\tif (frm.doc.default_fabric) {\n\t\t\tif(row.band==frm.doc.band){\n\t\t\trow.fabric_no = frm.doc.default_fabric;\n\t\t\trefresh_field(\"delivery_date\", cdn, \"items\");\n\t\t\t}\n\t\t} \n\t\tfrappe.model.set_value(cdt,cdn,\"warehouse\",\"MK - Finished Goods - Novo\")\n\t\tfrappe.model.set_value(cdt,cdn,\"jacket_options\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"trouser_options\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"waistcoat_options\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"fabric_no\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"lining_no\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"button\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"drawing_no\",\"\")\n\t\t\n\n},\nmake_sample_production_order:function(frm,cdt,cdn){\n\tvar doc=locals[cdt][cdn]\n\tfrappe.call({\n\t\tmethod:\"novo.api.makeSampleProductionOrder\",\n\t\targs:{'item_code':doc.item_code,'qty':doc.qty,'sales_order':doc.parent,'sales_order_item':doc.name,'d_no':doc.drawing_no,'measurement_no':cur_frm.doc.measurement},\n\t\tcallback:function(r){\n\n\t\t\t\tif(r.message){\n\t\t\t\t\t\tmsg='Sample Production Order Created: '+'<a href=\"#Form/Production Order/'+r.message+'\">'+r.message+'</a>'\n\t\t\t\t\t\tfrappe.msgprint(msg);\n\t\t\t\t\t\tcur_frm.reload()\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t})\n\n\n}\n\n\n\n\n})\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Item", 
  "modified": "2018-12-04 14:56:41.504981", 
  "name": "Item-Client", 
  "script": "frappe.ui.form.on('Item', {\n\trefresh: function(frm) {\n\n\n\n},\nitem_group:function(frm,cdt,cdn){\n\titem=locals[cdt][cdn]\n\tconsole.log(item)\n\tif(item.item_group==\"Main Fabric\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"FBRC .###\")\n\t\tfrappe.model.set_value(cdt,cdn,\"stock_uom\",\"Meter\")\t\t\n\t}\n\tif(item.item_group==\"Accessories\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"ACCS .######\")\n\t}\n\tif(item.item_group==\"Lining\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"LING .######\")\n\t\tfrappe.model.set_value(cdt,cdn,\"stock_uom\",\"Meter\")\t\t\n\t}\n\tif(item.item_group==\"Services\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"SRVC .######\")\n\t}\n\tif(item.item_group==\"Finished Goods\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"FGDS .######\")\n\t}\n\n}\n\n})\n\nfrappe.ui.form.on(\"Item\", \"after_save\", function(frm, cdt, cdn) {\n\n\t\t/*if(frm.doc.item_group==\"Main Fabric\" && frm.doc.material_type)\n\t\t{\n\t\t\t\t\t\n\n\n\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\tmethod:\"erpnext.api.makeBOM\",\n\t\t\t\t\t\targs:{'fabric_code':frm.doc.name,'material_type':frm.doc.material_type},\n\t\t\t\t\t\tcallback:function(r){\n\t\t\t\t\t\t\tvar bom_name=''\n\t\t\t\t\t\t\tfor(var item in r.message){\n\t\t\t\t\t\t\t\tbom_name=bom_name+'<a  style=\"color:#7277FF\" href=\"#Form/BOM/'+r.message[item][\"name\"]+'\">'+r.message[item][\"name\"]+'</a>'+',';\n\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar lastChar = bom_name.slice(-1);\n\t\t\t\t\t\t\t\tif (lastChar == ',') {\n\t\t\t\t\t\t\t\t\t    bom_name = bom_name.slice(0, -1);\n\t\t\t\t\t\t\t\t}\t\n\t\t\n\n\t\t\t\t\t\t\tfrappe.msgprint(\"BOM Created:\"+bom_name)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\n\n\t\t}\n\t\t*/\n\t})\n\n\n\nfrappe.ui.form.on(\"Item\", \"validate\", function(frm, cdt, cdn) {\n\n\t\tif(frm.doc.item_group==\"Finished Goods\")\n\t\t{\n\t\t\tif(!frm.doc.material_serial && !frm.doc.is_sample){\n\t\t\t\tfrappe.throw(\"Material Serial Is Mandatory\")\n\t\t\t}\n\t\t\t\n\t\t}\n\n\n\t\tif(frm.doc.item_group==\"Finished Goods\" || frm.doc.item_group==\"Main Fabric\")\n\t\t{\n\t\t\tif(!frm.doc.material_type && !frm.doc.is_sample){\n\t\t\t\t\tfrappe.throw(\"Band Is Mandatory\")\n\t\t\t\t}\n\t\t}\n\n\t\n})\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Production Order", 
  "modified": "2018-12-04 14:57:48.264100", 
  "name": "Production Order-Client", 
  "script": "", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Drawing", 
  "modified": "2018-10-12 19:59:41.485216", 
  "name": "Drawing-Client", 
  "script": "frappe.ui.form.on('Drawing', {\n\tdrawing_for: function(frm,cdt,cdn) {\n\t\td1=locals[cdt][cdn]\n\t\tif(d1.drawing_for==\"Jacket\")\n\t\t{\n\t\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"JCKT .######\")\n\t\t}\n\t\tif(d1.drawing_for==\"Trousers\")\n\t\t{\n\t\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"TRSR .######\")\n\t\t}\n\n\t\tif(d1.drawing_for==\"Waistcoat\")\n\t\t{\n\t\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"WSCT .######\")\n\t\t}\n\n\n\t}\n\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "BOM", 
  "modified": "2018-10-12 21:01:23.892722", 
  "name": "BOM-Client", 
  "script": "frappe.ui.form.on('BOM', {\nfor_fabric:function(frm,cdt,cdn){\n\titem=locals[cdt][cdn]\n\tconsole.log(item)\n\tif(parseInt(item.for_fabric)==1)\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"FBRC .######\")\t\n\t}\n\telse\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"naming_series\",\"BOM .######\")\t\n\t}\n\n\n}\n\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "IC Transfer And Transport Order", 
  "modified": "2018-11-12 20:29:14.818427", 
  "name": "Transfer-Client", 
  "script": "frappe.ui.form.on('IC Transfer And Transport Order', {\n\tonload: function(frm,cdt,cdn) {\n\t\tfrappe.call({\n\t\t\tmethod:\"erpnext.api.getItemForTransfer\",\n\t\t\targs:{'warehouse':'CHD - Finished Goods - BCC'},\n\t\t\tcallback:function(r){\n\t\t\t\tvar df = frappe.meta.get_docfield(\"Transfer Details\", \"item_n\", frm.doc.name);\n\t\t\t\tconsole.log(df)\t\t\n\t\t\t\tdf.options=r.message\n\t\t\t}\n\t\t\t\n\t\t\t})\n\t\t\n\n\t},\n\tvalidate:function(frm,cdt,cdn){\n\t\t\tdata=locals[cdt][cdn]\n\n\t\t\tif(data.workflow_state==\"Received\"){\n\n\t\t\t\t\tif(!data.to_warehouse){\n\t\t\t\t\t\tfrappe.throw(\"Target Warehouse Mandatory\")\t\t\n\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\tif(!data.received_date){\n\t\t\t\t\t\tfrappe.throw(\"Receiving Date Is Mandatory\")\t\t\n\t\t\t\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t\n\t\tif(data.workflow_state==\"In Transit\"){\n\n\t\t\t\t\tif(!data.in_transit_warehouse){\n\t\t\t\t\t\tfrappe.throw(\"In Transit Warehouse Mandotory\")\t\t\n\t\t\t\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\t\n\t\t}\n})\n\nfrappe.ui.form.on(\"IC Transfer And Transport Order\", \"after_save\", function(frm, cdt, cdn) {\n\t\t\n\t\tif(!frm.doc.sales_invoice_no && !frm.doc.purchase_invoice_no){\n\t\t\tif(frm.doc.workflow_state==\"Shipped\"){\n\t\t\tconsole.log(\"shipped\")\n\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\tmethod:\"erpnext.api.makeStockEntry\",\n\t\t\t\t\t\targs:{name:frm.doc.name},\n\t\t\t\t\t\tfreeze: true,\n\t\t\t\t\t\tfreeze_message: \"Please Wait...\",\n\t\t\t\t\t\tcallback:function(r){\n\t\t\t\t\t\t\tconsole.log(r)\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t})\n\n\t\t\t\t}\n\t\t}\n\n\n\t\n})\n\nfrappe.ui.form.on(\"IC Transfer And Transport Order\", \"on_submit\", function(frm, cdt, cdn) {\n\t\tdata=locals[cdt][cdn]\n\t\tif(data.workflow_state==\"Received\"){\n\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\tmethod:\"erpnext.api.makeStockEntry\",\n\t\t\t\t\t\targs:{name:data.name},\n\t\t\t\t\t\tfreeze: true,\n\t\t\t\t\t\tfreeze_message: \"Please Wait...\",\n\t\t\t\t\t\tcallback:function(r){\n\t\t\t\t\t\t\tconsole.log(r)\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\n\n\t\t\t\t}\n\n\n\t\n})\n\n\n\n\nfrappe.ui.form.on('Transfer Details', {\n\titem_n: function(frm,cdt,cdn) {\n\tchild=locals[cdt][cdn]\n\tconsole.log(child)\n\t\t\t\t\tfrappe.call({\n\t\t\t\t\t method: \"frappe.client.get_value\",\n\t\t\t\t\t args: { doctype: \"Item\", filters: {\"name\":child.item_n} ,fieldname:\"item_name\"}, \n\t\t\t\t\tcallback:function(r){\n\t\t\t\t\tconsole.log(r)\n\t\t\t\t\t\tfrappe.model.set_value(cdt,cdn,\"item_name\",r.message.item_name)\n\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\n\n\t}\n})\nconsole.log(cur_frm)\n\n\nfrappe.ui.form.on(\"IC Transfer And Transport Order\", \"shipped\", function(frm, cdt, cdn) {\n\tfrappe.msgprint(\"Test\");\n\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Send Message", 
  "modified": "2019-01-17 05:34:19.106468", 
  "name": "Send Message-Client", 
  "script": "frappe.ui.form.on('Send Message', {\n\tsales_order:function(frm,cdt,cdn){\n\t\tfrappe.model.set_value(cdt,cdn,\"message_type\",\"\")\n\t\tfrappe.model.set_value(cdt,cdn,\"message\",\"\")\n\t},\n\tmessage_type: function(frm,cdt,cdn) {\n\t\t  \n\t\t   data=locals[cdt][cdn]\n\t\t   if(!data.message_type=='' || data.message_type)\n\t\t  {\n                   frappe.call({\n                     \"method\": \"frappe.client.get_value\",\n                     \"args\": { doctype: \"Message\", filters: {\"name\":data.message_type} ,fieldname:\"message_format\"}, \n                    callback: function(r) { \n\t\t\t\tconsole.log(r.message.message_format)\n\t\t\t\tif(r.message.message_format){\n\t\t\t\t\tvar msg=r.message.message_format\n\t\t\t\t\tvar salutation=''\n                 \t\t\t frappe.call({\n                 \t\t\t    \"method\": \"frappe.client.get_value\",\n                 \t\t\t    \"args\": { doctype: \"Customer\", filters: {\"name\":data.customer} ,fieldname:\"salutation\"}, \n                    \t\t\t    callback: function(r) { \n\t\t\t\t\t\t\tif(r.message.salutation){\n\t\t\t\t\t\t\t\tconsole.log(r.message.salutation)\n\t\t\t\t\t\t\t\tsalutation=r.message.salutation\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\tsetTimeout(function(){ \n\t\t\t\t\tvar msg1=msg.replace('#title',salutation)\n\t\t\t\t\tconsole.log(\"mesg1\"+msg1)\n\t\t\t\t\tvar customer=data.customer_name\n\t\t\t\t\tvar last_name=customer.substring(customer.search(' '))\n\t\t\t\t\tvar msg2=msg1.replace('#last_name',last_name)\n\t\t\t\t\tconsole.log(msg2) \n\t\t\t\t\tfrappe.model.set_value(cdt,cdn,'message',msg2)\n\t\t\t\t\t},600)\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t\n\t\t\t})\n\t\t}\n\t\t\n\n\t},\n\tsend_message:function(frm,cdt,cdn){\n\t\t\tdata=locals[cdt][cdn]\n\t\t\tif(!data.contact_no){\n\t\t\t\tfrappe.throw(\"Contact No Is Mandatory\")\n\t\t\t}\n\t\t\tif(!data.sales_order){\n\t\t\t\tfrappe.throw(\"Sales Order Is Mandatory\")\n\t\t\t}\n\t\t\tif(!data.message){\n\t\t\t\tfrappe.throw(\"Message Is Mandatory\")\n\t\t\t}\n\t\t\tif(!data.message_type){\n\t\t\t\tfrappe.throw(\"Message Type Is Mandatory\")\n\t\t\t}\n\t\t\t\n\t\t\tfrappe.call({\n\t\t\t\tmethod:\"erpnext.sms_api.messageSend\",\n\t\t\t\targs:{'phone':data.contact_no,'message':data.message,'message_type':data.message_type,'customer':data.customer_name,'no':data.sales_order},\n\t\t\t\tcallback:function(r){\n\n\t\t\t\t\tconsole.log(r)\n\n\t\t\t\t}\n\n\t\t\t\n\t\t\t})\n\n\t}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sample Disposal Orders", 
  "modified": "2018-10-18 12:47:25.308095", 
  "name": "Sample Disposal Orders-Client", 
  "script": "frappe.ui.form.on('Sample Disposal Orders', {\n\tonload: function(frm) {\n\t\tfrappe.call({\n\t\t\tmethod:\"erpnext.api.getSampleItem\",\n\t\t\targs:{'item_group':'Finished Goods'},\n\t\t\tcallback:function(r){\n\t\t\t\tconsole.log(r)\n\t\t\t\tconsole.log(frm.doc.name)\n\t\t\t\tvar df = frappe.meta.get_docfield(\"Sample Disposal Orders Item\", \"item_n\", frm.doc.name);\n\t\t\t\tconsole.log(df)\t\t\n\t\t\t\tdf.options=r.message\n\t\t\t}\n\t\t\t\n\t\t\t})\n\t\t\n\n\t}\n})\n\nfrappe.ui.form.on('Sample Disposal Orders Item', {\n\titem_n: function(frm,cdt,cdn) {\n\tchild=locals[cdt][cdn]\n\tconsole.log(child)\n\t\t\t\t\tfrappe.call({\n\t\t\t\t\t method: \"frappe.client.get_value\",\n\t\t\t\t\t args: { doctype: \"Item\", filters: {\"name\":child.item_n} ,fieldname:\"item_name\"}, \n\t\t\t\t\tcallback:function(r){\n\t\t\t\t\tconsole.log(r)\n\t\t\t\t\t\tfrappe.model.set_value(cdt,cdn,\"item_name\",r.message.item_name)\n\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t})\t\t\n\n\n\t\n\t\t\t}\n\n})\nfrappe.ui.form.on(\"Sample Disposal Orders\", \"on_submit\", function(frm, cdt, cdn) {\n\t\tdata=locals[cdt][cdn]\n\t\t\n\t\tfrappe.call({\n\t\t\tmethod:\"erpnext.api.makeSampleIssue\",\n\t\t\targs:{name:data.name},\n\t\t\tfreeze: true,\n\t\t\tfreeze_message: \"Please Wait...\",\n\t\t\tcallback:function(r){\n\t\t\t\tconsole.log(r)\n\t\t\t}\n\t\t\n\t\t})\n\n\n\n\t\n})\n\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Inter Company Setting", 
  "modified": "2019-01-26 21:01:03.932624", 
  "name": "Inter Company Setting-Client", 
  "script": "frappe.ui.form.on(\"Inter Company Setting\", \"onload\", function(frm) {\n    cur_frm.set_query(\"supplier\", function() {\n        return {\n            \"filters\": {\n                \"supplier_type\": \"Intercompany\"\n            }\n        };\n    });\n});\n\ncur_frm.set_query(\"customer\",function() {\n    return {\n        query: \"erpnext.api.customer_query\"\n    };\n});\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2019-01-26 21:01:45.173069", 
  "name": "Sales Invoice-Client", 
  "script": "frappe.ui.form.on('Sales Invoice', {\n\tcompany: function(frm,cdt,cdn) {\n\t\tvar invoice=locals[cdt][cdn]\n\t\tif(invoice.company && invoice.posting_date){\n\t\t\tfrappe.call({\n\t\t\t\tmethod:\"erpnext.api.getFiscalYear\",\n\t\t\t\targs:{'company_name':invoice.company,'date':invoice.posting_date},\n\t\t\t\tcallback:function(r){\n\t\t\t\t\tfrappe.model.set_value(cdt,cdn,\"fiscal_year\",r.message)\n\t\t\t\t}\n\t\t\n\t\t\t})\n\t\t}\n\t\n\n\t},\n\tposting_date: function(frm,cdt,cdn) {\n\t\tvar invoice=locals[cdt][cdn]\n\t\tif(invoice.company && invoice.posting_date){\n\t\t\tfrappe.call({\n\t\t\t\tmethod:\"erpnext.api.getFiscalYear\",\n\t\t\t\targs:{'company_name':invoice.company,'date':invoice.posting_date},\n\t\t\t\tcallback:function(r){\n\t\t\t\t\tfrappe.model.set_value(cdt,cdn,\"fiscal_year\",r.message)\n\t\t\t\t}\n\t\t\n\t\t\t})\n\t\t}\n\t\n\n\t}\n\t\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2018-12-21 19:08:59.651219", 
  "name": "Customer-Client", 
  "script": "frappe.ui.form.on('Customer', {\nonload:function(frm,cdt,cdn){\n\tconsole.log(cur_frm);\n\tif(!cur_frm.doc.__islocal){\n\n\tfrm.add_custom_button(__('Make Visit'), function() {\n\n\t\t\tfrappe.call({\n\t\t\t\tmethod:'novo.api.makeVisit',\n\t\t\t\targs:{'customer':frm.doc.name,'customer_name':frm.doc.customer_name},\n\t\t\t\tcallback:function(res){\n\n\t\t\t\t\t\tif(res.message){\n\t\t\t\t\t\t\tvar msg='';\n\t\t\t\t\t\t\tmsg=msg+'<a  style=\"color:#7277FF\" href=\"#Form/Visit/'+res.message+'\">'+res.message+'</a>'\n\t\t\t\t\t\t\tfrappe.msgprint(\"Visit Created:\"+msg);\n\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\n\t\t\t})\n\t\t}\n\n}\n\t\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Measurement", 
  "modified": "2019-01-22 13:52:45.618805", 
  "name": "Measurement-Client", 
  "script": "/*\nfrappe.ui.form.on('Measurement', {\nafter_save:function(frm,cdt,cdn){\n\t\t\tfrappe.call({\n\t\t\t\tmethod:'novo.api.makeVisit',\n\t\t\t\targs:{'customer':frm.doc.customer,'customer_name':frm.doc.customer_name,},\n\t\t\t\tcallback:function(res){\n\n\t\t\t\t\t\t\t if(res.message){\t\t\t\t\t\t\t\t\t\t\t\t\t\t                   frappe.model.set_value(cdt,cdn,\"visit\",res.message)\t\n\t\t\t\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\n\n}\n\t\n})\n*/\n\nvar type='';\nvar name=''\n\nfrappe.ui.form.on('Measurement', {\nonload:function(frm,cdt,cdn){\n\t\tvar prev_route = frappe.get_prev_route();\n\t\ttype=prev_route[1]\n\t\tname=prev_route[2]\n\t\t\n},\nafter_save:function(frm,cdt,cdn){\n\t\tif (type=='Sales Order') {\n\t\t\tfrappe.set_route(\"Form\",\"Sales Order\",name,{\"measurement\":frm.doc.name});\n\t\t}\n\t\t\t\n\n\t}\n\t\n\n})", 
  "script_type": "Client"
 }
]